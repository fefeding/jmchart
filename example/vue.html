<!doctype html>
<html>
	<head>
	<meta content="text/html; charset=UTF-8" http-equiv="content-type" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>

		<style>
		html,body {
			margin:0;
			padding:0;
			width:100%;
			height:100%;
		}
        #mycanvas {
            text-align: center;
            margin-top: 10px;
        }
		#mycanvas canvas, #mycanvas div{
			background-color:#fff;
			margin:0 auto;		
		}
		/*div.jm-tooltip {
			background-color: rgba(255,255,255,0.8);
			padding:4px;
			border:1px solid #000;
			box-shadow: 0 0 3px #000;
			border-radius: 6px;
		}*/
		</style>
		
	</head>
	<body>
		<div id="app">
            <vchart :chart-data="chartData" 
                :chart-options="chartOptions" 
                :chart-series="chartSeries" 
                :width="width" :height="height">
            </vchart>
		</div>	
            <script type="module">
                import vchart from '../src/component/vchart.js';

                const options = {
                    //width: 800,  // 可以这里指定，也可以VUE属性指定
                    //height: 600,
                    xField: 'x',// X轴对应在数据中的字段名
                    enableAnimate: false,
                    legendPosition: 'top', // 图例位置 top left right bottom
                    legendVisible: false, // 不显示图例
                    // 最大和最小X值，  这里一般不用指定，除非硬是需要
                    minXValue : 0,
                    maxXValue : 10,
                    // 格式化x标签值
                    xLabelFormat: (v, item, index) => {
                        // 只展示第一个和最后一个
                        //if(index == 0 || index == datacount - 1) {
                        //    return v + '';
                        //}
                        return v + '';
                    },
                    style: {
                        // x轴 Y轴隐藏
                        axis: {
                            stroke: 'transparent',
                            grid: {
                                x: false,  // 不显示X轴网格
                                y: true     // 显示Y轴网格
                            }
                        },
                        // 隐藏边框
                        chartArea: {
                            stroke: 'transparent'
                        },
                        margin: {
                            top: 10,
                            left: 30,
                            right: 10,
                            bottom: 30
                        }
                    }
                };
                const series = [
                    {
                        type: 'line', // line bar pie spline
                        field: 'y1', // 当前图绑定的数据字段名  
                        legendLabel: '图例2',
                        // 最大值和最小值，如果不指定会自动计算，
                        // 如果指定了也只是指定了最大或最小边界，如果有数值超过它，依然以事实数值为准
                        minYValue: 1,
                        maxYValue: 5 ,
                        // 格式化y轴标签值
                        yLabelFormat: (v) => {
                            return v.toFixed? (v.toFixed(0) + '%') : v;
                        },
                        style: {
                            // 不显示小圆点
                            showItem: false,
                            color: '#C79156',
                            // 填充图形
                            area: true
                        }
                    }
                ];

                const app = new Vue({
                    el: '#app',
                    data: {
                        chartData: [],
                        // 图表配置
                        chartOptions: options,
                        // 图，可以指定多个
                        chartSeries: series,
                        width: '100%',
                        height: '400px'
                    },
                    components: {
                        vchart
                    }
                });

                (function load() {
                    //var w = Math.max((window.innerWidth || window.document.body.clientWidth) * 0.8, 400);
                    //var h = Math.min((window.innerHeight || window.document.body.clientHeight) * 0.5, 280);			
                    inichart();

                    setTimeout(()=>{
                        app.width = "800px";

                    }, 1000)
                })();
                
    
                function inichart() {
    
                        const datacount = 6;   
                        
                        function animate() {
                            const data = [];
                            for(var i = 0;i<datacount;i++) {
                                const d = {
                                    x : i,
                                    y1 :  Math.random() * 6,
                                    y2:  Math.random() * 200 + 50,
                                };
                                
                                data.push(d);
                            } 
                            
                            app.chartData = data;
                        }
                        
                        animate();    
                    }
            </script>	
	</body>
</html>