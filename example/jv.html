<!doctype html>
<html>
	<head>
		<meta content="text/html; charset=UTF-8" http-equiv="content-type" />
<meta name="viewport" content="width=device-width,initial-scale=1">
		<!--<script type="text/javascript" src="../src/jmchart.debug.js" id="jmgraph" ></script>-->

		<style>
		html,body {
			margin:0;
			padding:0;
			width:100%;
			height:100%;
		}
        #mycanvas {
            text-align: center;
            margin-top: 10px;
        }
		#mycanvas canvas, #mycanvas div{
			background-color:#fff;
			margin:0 auto;		
		}
		/*div.jm-tooltip {
			background-color: rgba(255,255,255,0.8);
			padding:4px;
			border:1px solid #000;
			box-shadow: 0 0 3px #000;
			border-radius: 6px;
		}*/
		</style>
		<script type="module">
			import jmChart from '../dist/bundle.esm.js';
			(function load() {
				var w = Math.max((window.innerWidth || window.document.body.clientWidth) * 0.8, 400);
				var h = Math.min((window.innerHeight || window.document.body.clientHeight) * 0.5, 280);			
				inichart(w,h);
			})();
			

			function inichart(w, h) {

                    const datacount = 6;

					const chart = new jmChart('mycanvas', {
						width: w,
						height: h,
                        xField: 'x',
                        enableAnimate: false,
                        legendPosition: 'top',
                        legendVisible: false, // 不显示图例
						// 最大和最小X值，  这里一般不用指定，除非硬是需要
						minXValue : 0,
						maxXValue : 10,
                        // 格式化x标签值
                        xLabelFormat: (v, item, index) => {
                            // 只展示第一个和最后一个
                            if(index == 0 || index == datacount - 1) {
                                return v + '';
                            }
                            return v+'';
                        },
                        style: {
                            // x轴 Y轴隐藏
                            axis: {
								stroke: 'transparent',
								align: 'center', // label居中对齐
                                grid: {
                                    x: false,  // 不显示X轴网格
                                    y: true     // 显示Y轴网格
                                }
                            },
                            // 隐藏边框
                            chartArea: {
                                stroke: 'transparent'
                            },
                            margin: {
                                top: 10,
                                left: 30,
                                right: 10,
                                bottom: 30
                            }
                        }
					});				

					const line = chart.createSeries('line', {
						field: 'y1',
						//index: 2, // 指定Y轴索引，如是档指定就会共用左边的Y轴，  
						legendLabel: '图例2',
						// 最大值和最小值，如果不指定会自动计算，
						// 如果指定了也只是指定了最大或最小边界，如果有数值超过它，依然以事实数值为准
						minYValue: 1,
                        maxYValue: 5 ,
                        // 格式化x轴标签值
                        yLabelFormat: (v) => {
                            return v.toFixed? (v.toFixed(0) + '%') : v;
                        },
                        style: {
                            // 不显示小圆点
							showItem: false,
							color: '#C79156',
							// 填充图形
							area: true
                        }
					});
					
					
					function animate() {
                        chart.data = [];
                        for(var i = 0;i<datacount;i++) {
                            const d = {
                                x : '0909' + i,
                                y1 :  Math.random() * 6,
                                y2:  Math.random() * 200 + 50,
                            };
                            
                            chart.data.push(d);
                        }
						
						//setTimeout(animate,500);
						chart.refresh();
						console.log(chart.data);
					}
					
					animate();

					chart.utils.bindEvent(document.getElementById('btnRedraw'),'click',function() {
							chart.data = [];
							//datacount = Math.random() * 10 + 4;
							for(var i = 0;i<datacount;i++) {
								var data = {
									x : i,
									y1 : Math.random() * 200 + 100,
									y2:Math.random() * 200,
									y3:Math.random() * 200 + 50,
									y4:Math.random() * 200 + 50,
									y5:Math.random() * 200 + 50,
									y6:Math.random() * 200 - 50,
									y7:Math.random() * 200 + 50,
									y8:Math.random() * 200 - 50,
									y9:Math.random() * 200 - 50,
									y10:Math.random() * 200 - 50
								};
								chart.data.push(data);
							}
							chart.refresh();
							//chart2.refresh();
						});
					
				}
		</script>
	</head>
	<body>
		<div id="mycanvas">
			</div>	
			<button id="btnRedraw">重绘</button>		
	</body>
</html>